<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AA電話</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div class="container">
        <h1>AA電話</h1>
        
        <div class="device-controls">
            <button id="mobileDeviceBtn" class="device-button mobile-device-btn">⚙️</button>
            <div class="device-row desktop-only">
                <label for="videoSelect">ビデオ:</label>
                <select id="videoSelect"></select>
                <label for="audioSelect">音声:</label>
                <select id="audioSelect"></select>
                <button id="refreshDevices">更新</button>
            </div>
        </div>
        
        <!-- ヘルプダイアログ -->
        <div id="helpDialog" class="help-dialog" style="display: none;">
            <div class="dialog-content">
                <div class="dialog-header">
                    <h3>使い方</h3>
                    <button id="closeHelpDialog">×</button>
                </div>
                <div class="dialog-body help-body">
                    <h4>AA電話とは</h4>
                    <p>ビデオをASCIIアート（文字）に変換してリアルタイムで通話するアプリです。</p>
                    <p>同じキーワードを入力した人と接続できます。</p>
                    
                    <h4>通話を始める</h4>
                    <ol>
                        <li><strong>ホスト側：</strong>
                            <ul>
                                <li>キーワードを入力（または自動生成されたものを使用）</li>
                                <li>「ホストする」ボタンをクリック</li>
                                <li>相手にキーワードを伝える</li>
                            </ul>
                        </li>
                        <li><strong>ゲスト側：</strong>
                            <ul>
                                <li>ホストから聞いたキーワードを入力</li>
                                <li>「参加する」ボタンをクリック</li>
                            </ul>
                        </li>
                    </ol>
                    
                    <h4>注意事項</h4>
                    <ul>
                        <li>ゲストは10分以内に参加する必要があります</li>
                        <li>カメラとマイクの使用許可が必要です</li>
                        <li>キーワードは他の人に推測されにくいものを使用してください</li>
                    </ul>
                    
                    <h4>デバイス設定</h4>
                    <p>⚙️ボタンでカメラとマイクを切り替えられます（通話中も可能）</p>
                    <p style="text-align: center; margin-top: 20px; font-size: 0.8em;">
                       © misebox 2025.
                    </p>
                </div>
            </div>
        </div>
        
        <!-- デバイス選択ダイアログ -->
        <div id="deviceDialog" class="device-dialog" style="display: none;">
            <div class="dialog-content">
                <div class="dialog-header">
                    <h3>デバイス選択</h3>
                    <button id="closeDialog">×</button>
                </div>
                <div class="dialog-body">
                    <div class="dialog-row">
                        <label for="videoSelectDialog">ビデオ:</label>
                        <select id="videoSelectDialog"></select>
                    </div>
                    <div class="dialog-row">
                        <label for="audioSelectDialog">音声:</label>
                        <select id="audioSelectDialog"></select>
                    </div>
                    <div class="dialog-buttons">
                        <button id="refreshDevicesDialog">更新</button>
                        <button id="applyDevices">適用</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <input type="text" id="keyword" placeholder="キーワードを入力">
            <button id="clearBtn" style="display: none;">クリア</button>
            <button id="hostBtn">ホストする</button>
            <button id="joinBtn">参加する</button>
            <button id="deviceBtn" class="device-button desktop-device-btn">⚙️</button>
            <button id="helpBtn" class="help-button">?</button>
            <button id="leaveBtn" style="display: none;">退室</button>
        </div>
        
        <div class="status desktop-status">
            <span id="statusText">未接続</span>
            <span id="timer"></span>
        </div>
        
        <div class="chat-area">
            <div class="video-container">
                <h3>相手</h3>
                <pre id="remoteAA" class="aa-display"></pre>
                <video id="remoteVideo" autoplay style="display: none;"></video>
            </div>
            
            <div class="status mobile-status">
                <span id="statusText2">未接続</span>
                <span id="timer2"></span>
            </div>
            
            <div class="video-container">
                <h3>自分</h3>
                <pre id="localAA" class="aa-display"></pre>
                <video id="localVideo" autoplay muted style="display: none;"></video>
            </div>
        </div>
        
        <canvas id="canvas" style="display: none;"></canvas>
    </div>
    
    <script src="./main.js"></script>
</body>
</html>
